version: '3.9'

services:
  frontend:
    image: frontend
    build:
      context: .
      dockerfile: ./Dockerfile
    environment:
      $PORT: 433
    ports:
      - 433:433
  api: 
    ports:
      - 5000:5000
    image: api
    depends_on:
      - db
    build: 
      context: ./backend
      dockerfile: ./Dockerfile
    links:
      - "db"
    environment:
      DATABASE_URL: postgresql+psycopg2://writingdashboard:6yE-N0vv~?(trP:B@db:5432/writingdashboard
      NUMWORKERS: 3
      NUMTHREADS: 3
      PORT: 5000
  db:
    environment:
      POSTGRES_USER: writingdashboard
      POSTGRES_PASSWORD: 6yE-N0vv~?(trP:B
      POSTGRES_DB: writingdashboard
    image: postgres:14-bullseye

